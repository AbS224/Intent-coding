# Crucible Engine Security Configuration
# Post-Security Review Implementation

# CSRF Protection Settings
CSRF_TOKEN_LENGTH=32
CSRF_TOKEN_EXPIRY=3600  # 1 hour
CSRF_HEADER_NAME=X-CSRF-Token

# Input Validation Settings
MAX_QUERY_LENGTH=1000
MAX_FILENAME_LENGTH=255
ALLOWED_FILE_EXTENSIONS=.md,.txt,.json,.yaml,.yml,.toml

# Path Security Settings
ALLOWED_BASE_PATHS=/tmp/crucible,./docs,./templates
BLOCKED_PATH_PATTERNS=..,~,/etc,/var,/usr,/bin,/sbin

# XSS Prevention Settings
HTML_ESCAPE_ENABLED=true
BLEACH_ALLOWED_TAGS=
BLEACH_ALLOWED_ATTRIBUTES=
BLEACH_STRIP_COMMENTS=true

# Cryptographic Settings
HASH_ALGORITHM=SHA256
ENCRYPTION_ALGORITHM=AES-256-GCM
KEY_DERIVATION=PBKDF2
KEY_ROTATION_DAYS=90

# Post-Quantum Cryptography
PQC_KEM_ALGORITHM=ML-KEM-768
PQC_DSA_ALGORITHM=ML-DSA-65

# Audit and Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=./logs/audit.log
SECURITY_LOG_LEVEL=INFO
LOG_RETENTION_DAYS=365

# Rate Limiting
API_RATE_LIMIT=1000  # requests per minute
BURST_LIMIT=100      # burst requests

# Session Management
SESSION_TIMEOUT=1800  # 30 minutes
SESSION_SECURE=true
SESSION_HTTPONLY=true
SESSION_SAMESITE=Strict

# Content Security Policy
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self' 'unsafe-inline'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data:
CSP_CONNECT_SRC='self'

# Security Headers
HSTS_MAX_AGE=31536000  # 1 year
HSTS_INCLUDE_SUBDOMAINS=true
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff
X_XSS_PROTECTION=1; mode=block
REFERRER_POLICY=strict-origin-when-cross-origin

# Development Security Settings (disable in production)
DEV_ALLOW_HTTP=false
DEV_DISABLE_CSRF=false
DEV_VERBOSE_ERRORS=false